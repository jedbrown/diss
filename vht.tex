We consider the problem of computing a steady-state energy (in the form of temperature, moisture, and kinetic energy) field coupled to a Stokes problem with rheology depending on strain rate, pressure, temperature, and melt fraction.
This problem is most important as part of inversion for a temperature field that is compatible with the observed geometry, flow field, borehole temperature measurements, and any other field observations.
Time-stepping a transient model to steady state is extremely expensive, therefore it will never be feasible as part of the functional to be minimized by an optimization algorithm.
The implicit method used for the steady-state prbolem can also be used to solve the transient system with time steps of arbitrary length, with no CFL stability limitation.
The transient system produces algebraic systems that are somewhat easier to solve numerically.

\subsection{Problem description}\label{ssec:vhtproblem}
\input{vhtproblem}

\subsection{Numerical solution}\label{sec:vhtsolution}
\input{vhtsolution}

\subsection{Verification}\label{ssec:vhtverif}
\input{vhtverif}

\subsection{A simple problem}\label{sec:vhtsimple}
\input{vhtsimple}
